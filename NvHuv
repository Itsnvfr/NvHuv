-- [[ CONFIGURATION ]]
local Config = {
    Aimbot = {Enabled = false, Smooth = 0.9, FOV = 80, Team = true}, -- Very low intensity boost
    Trigger = {Enabled = false, Delay = 0.15},
    Visuals = {ESP = false, Color = Color3.fromRGB(0, 255, 255)},
    UI = {Visible = true, Accent = Color3.fromRGB(0, 200, 255)}
}

-- [[ UI INITIALIZATION ]]
local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 700, 0, 450)
Main.Position = UDim2.new(0.5, -350, 0.5, -225)
Main.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
Main.BorderSizePixel = 0

local Corner = Instance.new("UICorner", Main)
Corner.CornerRadius = UDim.new(0, 15)

-- Container for Tabs
local TabFrame = Instance.new("Frame", Main)
TabFrame.Position = UDim2.new(0, 160, 0, 20)
TabFrame.Size = UDim2.new(1, -180, 1, -40)
TabFrame.BackgroundTransparency = 1

local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0, 150, 1, 0)
Sidebar.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
Instance.new("UIListLayout", Sidebar).Padding = UDim.new(0, 5)

-- [[ UI BUILDER ]]
local function CreateTab(name)
    local Page = Instance.new("ScrollingFrame", TabFrame)
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.BackgroundTransparency = 1
    Page.Visible = false
    Page.ScrollBarThickness = 0
    Instance.new("UIListLayout", Page).Padding = UDim.new(0, 10)

    local Btn = Instance.new("TextButton", Sidebar)
    Btn.Size = UDim2.new(1, 0, 0, 50)
    Btn.Text = name
    Btn.Font = Enum.Font.GothamBold
    Btn.TextSize = 18
    Btn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Btn.TextColor3 = Color3.fromRGB(255, 255, 255)

    Btn.MouseButton1Click:Connect(function()
        for _, v in pairs(TabFrame:GetChildren()) do v.Visible = false end
        Page.Visible = true
    end)
    return Page
end

local function AddToggle(parent, text, cfg, key)
    local Tgl = Instance.new("TextButton", parent)
    Tgl.Size = UDim2.new(1, 0, 0, 60)
    Tgl.Text = text .. ": OFF"
    Tgl.Font = Enum.Font.GothamBold
    Tgl.TextSize = 20
    Tgl.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Tgl.TextColor3 = Color3.fromRGB(255, 100, 100)
    Instance.new("UICorner", Tgl)

    Tgl.MouseButton1Click:Connect(function()
        cfg[key] = not cfg[key]
        Tgl.Text = text .. (cfg[key] and ": ON" or ": OFF")
        Tgl.TextColor3 = cfg[key] and Color3.fromRGB(100, 255, 100) or Color3.fromRGB(255, 100, 100)
    end)
end

-- Create Pages
local AimPage = CreateTab("Combat")
AddToggle(AimPage, "Aimbot Assist", Config.Aimbot, "Enabled")
AddToggle(AimPage, "Triggerbot", Config.Trigger, "Enabled")

local VisPage = CreateTab("Visuals")
AddToggle(VisPage, "Box ESP", Config.Visuals, "ESP")

local ConfigPage = CreateTab("Settings")
AddToggle(ConfigPage, "Team Check", Config.Aimbot, "Team")

-- [[ PERFORMANCE LOGIC ]]
local function GetClosest()
    local target, dist = nil, Config.Aimbot.FOV
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= game.Players.LocalPlayer and v.Character and v.Character:FindFirstChild("Head") then
            if Config.Aimbot.Team and v.Team == game.Players.LocalPlayer.Team then continue end
            local pos, vis = workspace.CurrentCamera:WorldToViewportPoint(v.Character.Head.Position)
            local mag = (Vector2.new(pos.X, pos.Y) - Vector2.new(game.Players.LocalPlayer:GetMouse().X, game.Players.LocalPlayer:GetMouse().Y)).Magnitude
            if vis and mag < dist then
                target = v
                dist = mag
            end
        end
    end
    return target
end

-- SAFE LOOP
game:GetService("RunService").Heartbeat:Connect(function()
    if Config.Aimbot.Enabled then
        local t = GetClosest()
        if t then
            local cam = workspace.CurrentCamera
            -- Ultra-Smooth Lerp to prevent pipeline crashes
            cam.CFrame = cam.CFrame:Lerp(CFrame.new(cam.CFrame.Position, t.Character.Head.Position), (1 - Config.Aimbot.Smooth) / 2)
        end
    end
end)

-- UI Toggle
game:GetService("UserInputService").InputBegan:Connect(function(io, gpe)
    if not gpe and io.KeyCode == Enum.KeyCode.RightShift then
        Main.Visible = not Main.Visible
    end
end)

TabFrame:GetChildren()[1].Visible = true
print("Glass Hub V6 - Anti-Crash Loaded")
