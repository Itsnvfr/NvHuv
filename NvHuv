-- [[ UTILITIES ]]
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera

-- [[ MASTER CONFIG ]]
local Config = {
    Aimbot = {Enabled = false, Smooth = 0.75, Shake = 0.01, Part = "Head", Team = true, Wall = true, FOV = 70}, -- Increased Smooth for "Low Boost"
    Silent = {Enabled = false, HitChance = 60, FOV = 90},
    Trigger = {Enabled = false, Delay = 0.2},
    Visuals = {Chams = false, Boxes = false, Team = true, Color = Color3.fromRGB(0, 255, 255)},
    UI = {Visible = true, Accent = Color3.fromRGB(0, 255, 255)}
}

-- [[ UI ENGINE ]]
local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 580, 0, 380)
Main.Position = UDim2.new(0.5, -290, 0.5, -190)
Main.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
Main.BackgroundTransparency = 0.2
Main.BorderSizePixel = 0

local Corner = Instance.new("UICorner", Main)
Corner.CornerRadius = UDim.new(0, 10)

-- Sidebar & Navigation
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0, 130, 1, 0)
Sidebar.BackgroundTransparency = 0.6
Sidebar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)

local TabContainer = Instance.new("Frame", Main)
TabContainer.Position = UDim2.new(0, 140, 0, 10)
TabContainer.Size = UDim2.new(1, -150, 1, -20)
TabContainer.BackgroundTransparency = 1

local Layout = Instance.new("UIListLayout", Sidebar)
Layout.Padding = UDim.new(0, 2)

-- Tab Creator
local function NewTab(name)
    local Btn = Instance.new("TextButton", Sidebar)
    Btn.Size = UDim2.new(1, 0, 0, 45)
    Btn.BackgroundTransparency = 1
    Btn.Text = name
    Btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    Btn.Font = Enum.Font.GothamMedium
    Btn.TextSize = 14

    local Page = Instance.new("ScrollingFrame", TabContainer)
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.Visible = false
    Page.BackgroundTransparency = 1
    Page.ScrollBarThickness = 0
    
    Btn.MouseButton1Click:Connect(function()
        for _, v in pairs(TabContainer:GetChildren()) do v.Visible = false end
        Page.Visible = true
    end)
    return Page
end

-- Create Tabs
local AimTab = NewTab("Aimbot")
local SilentTab = NewTab("Silent Aim")
local TrigTab = NewTab("Triggerbot")
local VisualTab = NewTab("Visuals")
local SkinTab = NewTab("Skinchanger")
local ConfigTab = NewTab("Settings")

-- [[ CORE FUNCTIONS ]]
local function IsAlive(plr)
    return plr and plr.Character and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health > 0
end

local function GetTarget(fov)
    local closest, target = fov, nil
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and IsAlive(v) then
            if Config.Aimbot.Team and v.Team == LocalPlayer.Team then continue end
            local pos, onScreen = Camera:WorldToViewportPoint(v.Character.Head.Position)
            if onScreen then
                local dist = (Vector2.new(pos.X, pos.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
                if dist < closest then
                    closest = dist
                    target = v
                end
            end
        end
    end
    return target
end

-- [[ STABLE LOGIC LOOPS ]]

-- Aimbot (Smooth & Safe)
RunService.RenderStepped:Connect(function()
    if Config.Aimbot.Enabled then
        local target = GetTarget(Config.Aimbot.FOV)
        if target then
            local pos = target.Character[Config.Aimbot.Part].Position
            -- Smoothness calculation to respect "Low Boost" request
            local smoothAmount = Config.Aimbot.Smooth / 12
            Camera.CFrame = Camera.CFrame:Lerp(CFrame.new(Camera.CFrame.Position, pos), smoothAmount)
        end
    end
end)

-- Visuals (Throttled to prevent freezing)
task.spawn(function()
    while true do
        task.wait(0.5) -- Updates twice a second instead of 60 times (Fixes freezing)
        if Config.Visuals.Chams then
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Character then
                    local highlight = p.Character:FindFirstChild("GlassHighlight") or Instance.new("Highlight", p.Character)
                    highlight.Name = "GlassHighlight"
                    highlight.Enabled = IsAlive(p)
                    highlight.FillColor = Config.Visuals.Color
                end
            end
        end
    end
end)

-- UI Toggle
UIS.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.RightShift then
        Main.Visible = not Main.Visible
    end
end)

-- Set Default Page
TabContainer:GetChildren()[1].Visible = true

print("V3 Clean Load | Zero-Freeze Engine Active")
